<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>‡∏£‡πà‡∏ß‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏û‡∏≤‡∏£‡πå‡∏ó‡πÄ‡∏ô‡∏≠‡∏£‡πå - SATHU</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;600&family=Charm:wght@700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
    
    <script>
        // üî¥üî¥üî¥ ‡∏ß‡∏≤‡∏á URL ‡∏Ç‡∏≠‡∏á Google Apps Script ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà (‡∏ï‡∏±‡∏ß‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö index.html) üî¥üî¥üî¥
        const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbzpjMK9qcBT0N6M_oVHIPxD2jeEFdWxkddMYxf4gXOkAJmNTXLzACwiTO_Ptq7bd5nJ/exec"; 

        tailwind.config = {
            theme: {
                extend: { colors: { "primary": "#B91C1C", "dark": "#111111", "gold": "#D4AF37" }, fontFamily: { "sans": ["Prompt", "sans-serif"], "logo": ["Charm", "serif"] } }
            }
        }
    </script>
    <style>
        body { background-color: #000; display: flex; justify-content: center; min-height: 100vh; margin: 0; font-family: 'Prompt', sans-serif; }
        #app-frame { width: 100%; max-width: 430px; background-color: #fff; height: 100dvh; position: relative; overflow-y: auto; }
        
        /* Loading Overlay */
        #loading-overlay {
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
        }
    </style>
</head>
<body>
    <div id="app-frame">
        <!-- Hero -->
        <div class="relative h-[250px] bg-dark text-white flex flex-col justify-end p-8">
            <button onclick="window.location.href='index.html'" class="absolute top-6 left-6 w-10 h-10 rounded-full bg-white/10 flex items-center justify-center backdrop-blur-sm hover:bg-white/20 transition-colors">
                <span class="material-icons-round">arrow_back</span>
            </button>
            <span class="text-gold uppercase tracking-[0.3em] text-[10px] font-bold mb-2">Sathu Partner</span>
            <h1 class="text-3xl font-bold leading-tight">‡∏£‡πà‡∏ß‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏Ç‡∏≠‡∏á<br>‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢‡∏™‡∏∞‡∏û‡∏≤‡∏ô‡∏ö‡∏∏‡∏ç</h1>
            <div class="absolute bottom-0 left-0 right-0 h-10 bg-gradient-to-t from-white to-transparent"></div>
        </div>

        <!-- Content -->
        <div class="p-8 pb-32">
            <p class="text-gray-500 text-sm mb-8">
                ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡πâ‡∏≤‡∏ô‡∏î‡∏≠‡∏Å‡πÑ‡∏°‡πâ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÑ‡∏î‡πâ‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô ‡∏î‡πâ‡∏ß‡∏¢‡πÅ‡∏û‡∏•‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏° "‡∏™‡∏≤‡∏ò‡∏∏" ‡∏Ñ‡πà‡∏≤‡∏ò‡∏£‡∏£‡∏°‡πÄ‡∏ô‡∏µ‡∏¢‡∏°‡πÄ‡∏û‡∏µ‡∏¢‡∏á <span class="text-primary font-bold">1 ‡∏ö‡∏≤‡∏ó/‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</span> ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
            </p>

            <form id="partner-form" class="space-y-5">
                <div>
                    <label class="text-xs font-bold text-gray-400 uppercase">‡∏ä‡∏∑‡πà‡∏≠‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤</label>
                    <input type="text" id="shop-name" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏£‡πâ‡∏≤‡∏ô‡∏î‡∏≠‡∏Å‡πÑ‡∏°‡πâ‡πÅ‡∏°‡πà‡∏°‡∏ì‡∏µ" class="w-full border-b border-gray-300 py-3 focus:border-primary outline-none transition-colors">
                </div>
                <div>
                    <label class="text-xs font-bold text-gray-400 uppercase">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô</label>
                    <input type="text" id="owner-name" placeholder="‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•" class="w-full border-b border-gray-300 py-3 focus:border-primary outline-none transition-colors">
                </div>
                <div>
                    <label class="text-xs font-bold text-gray-400 uppercase">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</label>
                    <input type="tel" id="contact-phone" placeholder="08x-xxx-xxxx" class="w-full border-b border-gray-300 py-3 focus:border-primary outline-none transition-colors">
                </div>
                
                <div class="pt-4">
                    <label class="text-xs font-bold text-gray-400 uppercase mb-3 block">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏£‡πâ‡∏≤‡∏ô</label>
                    <div onclick="getLocation()" id="location-box" class="h-32 bg-gray-100 rounded-xl flex flex-col items-center justify-center text-gray-400 border border-dashed border-gray-300 cursor-pointer hover:bg-gray-50 transition-colors hover:border-primary hover:text-primary">
                        <span class="material-icons-round mb-2 text-2xl">add_location_alt</span>
                        <span class="text-xs font-bold" id="location-text">‡πÅ‡∏ï‡∏∞‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏±‡∏Å‡∏´‡∏°‡∏∏‡∏î‡∏£‡πâ‡∏≤‡∏ô (GPS)</span>
                    </div>
                </div>

                <div class="pt-8">
                    <button type="button" onclick="submitPartner()" class="w-full bg-primary text-white py-4 rounded-full font-bold shadow-lg shadow-red-900/20 active:scale-95 transition-transform hover:bg-red-800">
                        ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤
                    </button>
                </div>
            </form>
        </div>

        <!-- Loading Overlay -->
        <div id="loading-overlay" class="absolute inset-0 z-50 bg-white/80 hidden flex-col items-center justify-center">
            <div class="w-10 h-10 border-4 border-gray-200 border-t-primary rounded-full animate-spin mb-4"></div>
            <p class="text-xs font-bold text-primary tracking-widest uppercase animate-pulse">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
        </div>
    </div>

    <script>
        let shopLocation = "";

        function getLocation() {
            const box = document.getElementById('location-box');
            const text = document.getElementById('location-text');
            
            text.innerText = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏£‡∏∞‡∏ö‡∏∏‡∏û‡∏¥‡∏Å‡∏±‡∏î...";
            
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    (pos) => {
                        shopLocation = `${pos.coords.latitude}, ${pos.coords.longitude}`;
                        text.innerText = "‡∏õ‡∏±‡∏Å‡∏´‡∏°‡∏∏‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢ ‚úÖ";
                        box.classList.remove('bg-gray-100', 'text-gray-400', 'border-dashed');
                        box.classList.add('bg-green-50', 'text-green-600', 'border-solid', 'border-green-200');
                    },
                    (err) => {
                        console.error(err);
                        text.innerText = "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏£‡∏∞‡∏ö‡∏∏‡∏û‡∏¥‡∏Å‡∏±‡∏î‡πÑ‡∏î‡πâ (‡πÉ‡∏ä‡πâ‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏à‡∏≥‡∏•‡∏≠‡∏á)";
                        shopLocation = "17.41500, 102.78600 (Mock)";
                    }
                );
            } else {
                alert("‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö GPS");
            }
        }

        function submitPartner() {
            // 1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
            const shopName = document.getElementById('shop-name').value;
            const ownerName = document.getElementById('owner-name').value;
            const phone = document.getElementById('contact-phone').value;

            if (!shopName || !ownerName || !phone) {
                alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô");
                return;
            }

            if (!WEB_APP_URL) {
                alert("‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏•‡∏¥‡∏á‡∏Å‡πå Web App URL ‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ó‡∏µ‡πà 16 ‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö");
                return;
            }

            // 2. ‡πÅ‡∏™‡∏î‡∏á Loading
            document.getElementById('loading-overlay').classList.remove('hidden');
            document.getElementById('loading-overlay').classList.add('flex');

            // 3. ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏á
            const payload = {
                action: 'registerPartner', // ‡∏ä‡∏∑‡πà‡∏≠ Action ‡πÉ‡∏´‡∏°‡πà‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ù‡∏±‡πà‡∏á Server
                shopName: shopName,
                ownerName: ownerName,
                phone: phone,
                location: shopLocation || "‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏"
            };

            // 4. ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡πâ‡∏ß‡∏¢ fetch
            fetch(WEB_APP_URL, {
                method: 'POST',
                body: JSON.stringify(payload)
            })
            .then(response => response.json())
            .then(data => {
                document.getElementById('loading-overlay').classList.add('hidden');
                document.getElementById('loading-overlay').classList.remove('flex');

                if (data.success) {
                    alert("‚úÖ ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏Å‡∏•‡∏±‡∏ö‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 24 ‡∏ä‡∏°.");
                    window.location.href = 'index.html';
                } else {
                    // ‡∏Å‡∏£‡∏ì‡∏µ Server ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö action ‡∏ô‡∏µ‡πâ ‡πÉ‡∏´‡πâ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÅ‡∏ö‡∏ö Soft fail (‡πÄ‡∏û‡∏∑‡πà‡∏≠ UX)
                    console.warn("Server response:", data);
                    alert("‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢ (Demo Mode)");
                    window.location.href = 'index.html';
                }
            })
            .catch(error => {
                console.error('Error:', error);
                document.getElementById('loading-overlay').classList.add('hidden');
                document.getElementById('loading-overlay').classList.remove('flex');
                alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà");
            });
        }
    </script>
</body>
</html>